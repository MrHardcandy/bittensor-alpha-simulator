# 🧠 Bittensor 子网收益模拟器 (v2.0)

一个专业、高精度的 Bittensor 子网经济模型分析、策略优化及多场景对比工具。本项目精确复现了 `subtensor` 链上核心的经济逻辑，并提供可交互的 Web 界面，帮助您做出更明智的投资决策。

## ✨ 核心特性

*   **🎛️ 精确的经济模型**: 严格遵循 `subtensor` 源码，实现了动态 TAO 发行、基于 EMA 价格的份额计算、AMM 资金池运作以及 Epoch 周期的奖励分配。
*   **🔬 灵活的场景模拟**:
    *   **可调 `Moving Alpha` (α) 参数**: 实时调整价格收敛速度，适配不同类型的子网。
    *   **可调 TAO 产生速率**: 模拟网络在不同发行阶段（如减半后）的宏观经济状况。
    *   **可调奖励份额**: 精确模拟您在子网中所占的贡献比例。
    *   **可调市场抛压**: 通过"外部卖出压力"参数，模拟其他参与者的市场行为对价格的影响。
*   **📈 交互式可视化界面**: 基于 Streamlit 构建，所有参数均可通过滑块实时调节，结果即时反馈。
*   **🚀 一键部署**: 支持本地运行，无需复杂配置。

## 🚀 快速开始

### 本地运行

```bash
# 克隆最新版本的项目
git clone https://github.com/MrHardcandy/bittensor-alpha-simulator.git
cd bittensor-alpha-simulator

# (推荐) 创建并激活虚拟环境
python3 -m venv sim_env
source sim_env/bin/activate

# 安装依赖
pip install -r requirements.txt

# 启动Web界面
streamlit run app.py
```

启动后，访问浏览器中提示的地址（通常是 `http://localhost:8501`）。

## 🎛️ 关键可调参数详解

所有参数均可在左侧边栏进行调整。

#### 核心环境参数

*   **TAO产生速率 (个/12秒)**: 控制每个区块全网产生的 TAO 数量。这是影响整个模拟经济体中资金流入速度的最宏观变量。
*   **Moving Alpha (α)**: EMA 平滑因子。
    *   **低值 (e.g., 0.01)**: 价格非常稳定，对短期市场波动不敏感，适合模拟成熟、稳定的子网。
    *   **高值 (e.g., 0.15)**: 价格对实时变化更敏感，收敛速度快，适合模拟新兴、快速变化的子网。
    *   **默认值 `0.1526`**: 与 `subtensor` 源码中的默认配置完全一致。

#### 收益与市场行为参数

*   **我的奖励份额 (%)**: 决定了在每个 Epoch 周期结算时，您能获得 dTAO 总奖励的百分比。例如，设为 `95%` 表示您获得了 95% 的奖励，另外 5% 被视为外部参与者的。
*   **外部卖出压力 (%)**: 决定了外部参与者在获得他们的 dTAO 奖励后，会立即卖掉的比例。这是模拟市场抛压的关键。例如，设为 `50%` 表示外部参与者会立刻卖掉他们所获奖励的一半。

## 🎯 策略说明

模拟器内置的 `TempoSellStrategy` 策略遵循一个三阶段模型：

1.  **积累阶段**: 在 dTAO 价格低于"买入阈值"时，动用预算持续买入 dTAO。
2.  **一次性卖出阶段**: 当 AMM 池中的 TAO 总量达到"总预算"的"触发倍数"时，执行一次大规模卖出，收回成本并锁定利润，但会保留指定数量的 dTAO。
3.  **长尾收益阶段**: 在大规模卖出后，策略会将后续获得的每一笔 dTAO 奖励，在很短的延迟后自动卖出，持续获取长尾收益。

## 🤝 贡献

欢迎通过提交 Issue 和 Pull Request 来为这个项目做出贡献。

## 📄 许可证

本项目采用 MIT 许可证。详情请见 `LICENSE` 文件。

## 📊 功能模块

### 1. 核心模拟引擎
- `src/core/amm_pool.py` - AMM池恒定乘积模型
- `src/core/emission.py` - 排放计算和分配逻辑
- `src/simulation/simulator.py` - 主模拟引擎

### 2. 交易策略
- `src/strategies/tempo_sell_strategy.py` - Tempo卖出策略

### 3. Web界面
- `app.py` - 主应用入口
- `src/visualization/` - 可视化组件

### 4. 分析工具
- `scripts/debug_alpha_impact.py` - Alpha参数影响诊断
- `scripts/analyze_roi_sources.py` - ROI来源分析
- `scripts/system_validation.py` - 系统验证

## 🔬 验证结果

基于真实子网数据验证：
- ✅ Alpha参数正确传递和使用
- ✅ 5倍差异验证通过 (0.02 vs 0.1)
- ✅ 系统完整性验证通过

## 📈 使用案例

### 快速对比不同Alpha值
1. 设置模拟时间：180天
2. 调整Alpha参数：0.001 vs 0.2
3. 运行多场景对比
4. 查看排放份额和ROI差异

### 优化投资策略
1. 使用TAO产生速率对比功能
2. 测试不同触发倍数
3. 分析买入阈值影响
4. 找到最优参数组合

## 🛡️ 技术特点

- **高精度计算** - 基于Decimal，确保精确性
- **模块化设计** - 清晰的代码架构，易于扩展
- **实时验证** - 内置系统验证和诊断工具
- **用户友好** - 中文界面，详细的参数说明

## 📝 更新日志

### v1.0.0 (2024-12-03)
- ✨ 可调Moving Alpha参数
- 📊 多策略对比分析
- 🔬 真实数据验证
- 🚀 云端部署支持

## 🔗 相关链接

- [TaoStats](https://taostats.io/) - Bittensor网络统计
- [Bittensor文档](https://docs.bittensor.com/)
